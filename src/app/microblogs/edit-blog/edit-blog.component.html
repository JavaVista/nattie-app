<ion-content [fullscreen]="true">
  <form [formGroup]="form">
    <ion-card>
      <ion-card-content>
        <ion-label>Title</ion-label>
        <ion-input
          formControlName="title"
          placeholder="Enter a blog title"
          [counter]="true"
          maxlength="40"
          [clearInput]="true"
          required
        ></ion-input>
        @if (form.get('title')?.touched && form.get('title')?.invalid) {
        <p class="error">Title is required (min 5 characters).</p>
        }

        <quill-editor
          (onEditorChanged)="onEditorChange($event)"
          formControlName="content"
          format="object"
          [styles]="quillStyles"
        >
        </quill-editor>
        @if (form.get('content')?.touched && form.get('content')?.invalid) {
        <div class="error">Content must be at least 10 characters.</div>
        }

        <div class="file-upload-container">
          <h4>
            <ion-icon name="images-outline"></ion-icon>
            Gallery Images
          </h4>

          <div class="image-preview-container">
            @for (img of galleryImages(); track $index) {
            <div class="image-preview">
              <img [src]="img" alt="Gallery image" />
              <ion-button
                shape="round"
                fill="solid"
                size="small"
                color="danger"
                (click)="removeImage($index)"
              >
                <ion-icon name="trash-outline" slot="icon-only"></ion-icon>
              </ion-button>
            </div>
            }
          </div>
        </div>

        <ion-button
          shape="round"
          expand="block"
          color="success"
          (click)="saveChanges()"
          [disabled]="form.invalid"
        >
          Save Changes
        </ion-button>
      </ion-card-content>
    </ion-card>
  </form>
</ion-content>
